<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Vulnerability Criticality Re‑Scorer – ABI Consulting</title>
<meta content="#0B1E39" name="theme-color"/>
<style>
    :root{
      --bg:#0B1E39; --panel:#0e2446; --panel2:#0b1d37;
      --text:#F5F7FB; --muted:#A3B3CC;
      --accent:#2E8CFF; --accent2:#74B2FF; --ok:#5bd68a; --warn:#ffb454; --crit:#ff7a7a;
      --border:rgba(255,255,255,.08); --shadow:0 16px 40px rgba(0,0,0,.35);
      --radius:18px; --maxw:1200px;
    }
    *{box-sizing:border-box}
    body{margin:0;background:radial-gradient(1200px 600px at 10% -10%, rgba(116,178,255,.12), transparent),
                    radial-gradient(900px 500px at 90% 10%, rgba(46,140,255,.12), transparent),
                    var(--bg);
         color:var(--text);
         font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
    a{color:var(--accent)}
    header{padding:24px 0;border-bottom:1px solid var(--border)}
    .container{width:min(100%,var(--maxw));margin:0 auto;padding:0 20px}
    .brand{display:flex;align-items:center;gap:12px;font-weight:800}
    
    h1{font-size:clamp(28px,3.2vw,40px);margin:12px 0 4px}
    p.lead{color:var(--muted);margin:0 0 18px}
    .cols{display:grid;grid-template-columns:1fr 1fr;gap:18px;align-items:start}
    @media (max-width:980px){ .cols{grid-template-columns:1fr} }
    .card{background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01));
          border:1px solid var(--border); border-radius:var(--radius); padding:18px;
          box-shadow:var(--shadow)}
    .card h2{margin:6px 0 10px}
    fieldset{border:none;margin:0;padding:0}
    label{display:block;margin:10px 0 6px}
    select,input[type="number"]{width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(255,255,255,.02);color:var(--text)}
    .check{display:flex;gap:8px;align-items:center;margin:6px 0}
    .actions{display:flex;gap:12px;flex-wrap:wrap;margin-top:14px}
    button{cursor:pointer;padding:12px 18px;border-radius:999px;background:var(--accent);color:#fff;font-weight:700;border:1px solid rgba(255,255,255,.08)}
    .secondary{background:transparent;border:1px solid var(--accent2);color:#fff}
    .result{border:1px solid var(--border);border-radius:var(--radius);padding:16px;background:rgba(116,178,255,.06);margin-top:12px}
    .pill{display:inline-block;border:1px solid var(--border);border-radius:999px;padding:4px 10px;margin-left:6px}
    .badge{display:inline-block;padding:4px 10px;border-radius:999px;margin-left:8px;font-size:13px}
    .sev-Critical{background:rgba(255,122,122,.15);border:1px solid rgba(255,122,122,.45)}
    .sev-High{background:rgba(255,180,84,.15);border:1px solid rgba(255,180,84,.45)}
    .sev-Medium{background:rgba(116,178,255,.15);border:1px solid rgba(116,178,255,.45)}
    .sev-Low{background:rgba(91,214,138,.15);border:1px solid rgba(91,214,138,.45)}
    .scorebar{height:12px;border-radius:999px;background:rgba(255,255,255,.08);overflow:hidden;margin-top:6px}
    .scorebar>div{height:100%;background:linear-gradient(90deg,#2E8CFF,#74B2FF)}
    .muted{color:var(--muted)}
    .limit{display:flex;align-items:center;gap:8px;padding:10px;border:1px dashed var(--border);
           border-radius:12px;background:rgba(255,255,255,.03);margin:10px 0}
    .limit strong{color:#dfe9ff}
    .disabled{opacity:.55;pointer-events:none}
    /* --- Top nav (unify with index.html) --- */
header.nav {
  position: sticky;
  top: 0;
  z-index: 1000;
  background: var(--bg);
  padding: 20px 0;
  border-bottom: 1px solid var(--border);
}
header.nav .container {
  width: min(100%, var(--maxw));
  margin: 0 auto;
  padding: 0 20px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
}


/* Nav links */
header.nav nav a,
header.nav nav a:visited {
  color: #dfe9ff;
  text-decoration: none;
  margin-left: 22px;
}
header.nav nav a:hover {
  color: var(--accent2);
  text-decoration: underline;
}

  

/* --- Force the header logo to match homepage --- */


/* Kill any old badge/gradient styles applied to .logo */
header.nav 


/* === Enforce header identical to index === */
header.nav .container{
  display:flex !important;
  align-items:center !important;
  justify-content:space-between !important;
  gap:16px !important;
  height:56px !important;
}
header.nav .brand{
  display:flex !important;
  align-items:center !important;
  gap:10px !important;
}
header.nav .brand .logo, header.nav img.logo{
  position: static !important;
  height: 22px !important;
  width: auto !important;
  display: inline-block !important;
  object-fit: contain !important;
  background: none !important;
  border-radius: 0 !important;
  box-shadow: none !important;
  padding: 0 !important;
  margin: 0 !important;
}
header.nav .brand span{
  color:#ffffff !important;
  font-weight:700 !important;
}
header.nav nav a{
  margin: 0 14px !important;
  color: #cfe1ff !important;
  text-decoration: none !important;
}
header.nav nav a:hover{ color:#ffffff !important; }

</style>
</head>
<body>
<header class="nav">
<div class="container" style="display:flex;align-items:center;justify-content:space-between;gap:16px;">
<div class="brand"><img alt="ABI Consulting logo" class="logo" src="assets/ABI_logo_transparent.png"/><span>Consulting, LLC</span></div>
<nav>
<a href="index.html">Home</a>
<a href="#about">About</a>
<a href="#services">Services</a>
<a href="#resources">Resources</a>
<a href="#partners">Trusted Partners</a>
<a href="/blog">Blog</a>
<a href="#contact">Contact</a>
<a aria-label="LinkedIn" class="social-link" href="https://www.linkedin.com/company/abi-consulting-llc" target="_blank">
<svg fill="currentColor" height="18" viewbox="0 0 16 16" width="18" xmlns="http://www.w3.org/2000/svg">
<path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 
             .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 
             14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 
             0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 
             0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 
             1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.175-.431.574-.878 
             1.244-.878.878 0 1.23.662 1.23 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 
             0-1.845.7-2.165 1.193h.016V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"></path>
</svg>
</a>
</nav>
</div>
</header>
<main class="container">
<h1>Vulnerability Criticality Re‑Scorer</h1>
<p class="lead">From simple CVE categories to advanced context-aware rescoring—see how business impact and exploitability change priorities.</p>
<section class="cols">
<!-- Lite -->
<div class="card">
<h2>Lite</h2>
<fieldset>
<label>CVE severity</label>
<select id="l_cve">
<option value="10">Critical</option>
<option value="7.5">High</option>
<option value="5">Medium</option>
<option value="2.5">Low</option>
</select>
<label>Asset criticality</label>
<!-- multipliers: High boosts, Low reduces -->
<select id="l_asset">
<option value="1.25">High</option>
<option value="1.00">Medium</option>
<option value="0.80">Low</option>
</select>
<label>Business impact</label>
<select id="l_biz">
<option value="1.25">High</option>
<option value="1.00">Medium</option>
<option value="0.80">Low</option>
</select>
</fieldset>
<div class="actions">
<button id="liteCalc">Re-score</button>
<button class="secondary" id="liteReset">Reset</button>
</div>
<div class="result" id="liteOut" style="display:none"></div>
</div>
<!-- Pro -->
<div class="card" id="proCard">
<h2>Pro</h2>
<div class="limit">Pro mode uses remaining: <strong id="usesLeft">5</strong></div>
<fieldset>
<label>CVSS base score (0–10)</label>
<input id="p_cvss" max="10" min="0" step="0.1" type="number" value="7.5"/>
<label>EPSS probability (%)</label>
<input id="p_epss" max="100" min="0" step="0.1" type="number" value="0"/>
<div class="check"><input id="p_kev" type="checkbox"/> <span>On CISA KEV</span></div>
<div class="check"><input id="p_exploited" type="checkbox"/> <span>Known exploited</span></div>
<div class="check"><input id="p_exploitcode" type="checkbox"/> <span>Public exploit code</span></div>
<label>Attack surface</label>
<select id="p_surface"><option value="1.00">External / internet‑facing</option><option value="0.90">Internal</option><option value="0.80">Privileged / admin‑only</option></select>
<label>Ubiquity (# affected assets)</label>
<select id="p_scope"><option value="0.5">Many (10+)</option><option value="0.2">Few (2–10)</option><option value="0">One</option></select>
<label>Asset criticality</label>
<select id="p_asset"><option value="1.15">High</option><option value="1.00">Medium</option><option value="0.85">Low</option></select>
<label>Business impact</label>
<select id="p_biz"><option value="1.15">High</option><option value="1.00">Medium</option><option value="0.85">Low</option></select>
<label>Data sensitivity</label>
<select id="p_data"><option value="1.15">Restricted</option><option value="1.08">Confidential</option><option value="1.02">Internal</option><option value="1.00">Public</option></select>
<label>Compensating controls</label>
<select id="p_controls"><option value="1.00">None</option><option value="0.90">Partial</option><option value="0.80">Strong</option></select>
</fieldset>
<div class="actions"><button id="proCalc">Re‑score</button><button class="secondary" id="proReset">Reset</button></div>
<div class="result" id="proOut" style="display:none"></div>
<p class="muted" style="margin-top:8px">Want unlimited access? Contact <a href="mailto:damian@abiconsulting.llc">ABI Consulting</a>.</p>
</div>
</section>
</main>
<script>
  function band(score){ if(score>=9) return 'Critical'; if(score>=7.5) return 'High'; if(score>=5) return 'Medium'; return 'Low'; }
  function sla(sev, external, activeSignals){
    if(sev==='Critical') return (external||activeSignals) ? '24–72h (external/active signal), else 7 days' : '7 days';
    if(sev==='High') return (external||activeSignals) ? '7 days (external/active signal), else 14–21 days' : '14–21 days';
    if(sev==='Medium') return '30 days'; return '90 days';
  }

// Lite (multiplicative + SLA output)
document.getElementById('liteCalc').addEventListener('click', () => {
  const base  = parseFloat(document.getElementById('l_cve').value);
  const asset = parseFloat(document.getElementById('l_asset').value);
  const biz   = parseFloat(document.getElementById('l_biz').value);

  let score = base * asset * biz;
  score = Math.max(0, Math.min(10, score));

  const sev = band(score);   // reuses your band() function
  const out = document.getElementById('liteOut');
  out.style.display = 'block';
  out.innerHTML = `
    <h3>Rescored severity: <span class="badge sev-${sev}">${sev}</span>
      <span class="pill">${score.toFixed(1)}/10</span></h3>
    <div class="scorebar"><div style="width:${(score/10)*100}%"></div></div>
    <p class="muted"><strong>Model:</strong> CVE × Asset × Business</p>
    <p><strong>Suggested remediation SLA:</strong> ${sla(sev,false,false)}</p>
  `;
});


  document.getElementById('liteReset').addEventListener('click', ()=>{ document.getElementById('liteOut').style.display='none'; });

  // IP-aware use limits (hash IP + localStorage)
  const LIMIT=5; let KEY='abi_vm_pro_uses_generic';
  function h(s){let x=5381;for(let i=0;i<s.length;i++)x=((x<<5)+x)+s.charCodeAt(i);return (x>>>0).toString(16);}
  fetch('https://api.ipify.org?format=json').then(r=>r.json()).then(({ip})=>{KEY='abi_vm_pro_uses_'+h(ip);u();}).catch(()=>u());
  function g(){return Number(localStorage.getItem(KEY)||'0');}
  function sset(v){localStorage.setItem(KEY,String(v));}
  function u(){const left=Math.max(LIMIT-g(),0);const b=document.getElementById('proCalc');document.getElementById('usesLeft').textContent=left;b.disabled=left<=0;b.classList.toggle('disabled',left<=0);}

  // Pro calc (multiplicative model)
  document.getElementById('proCalc').addEventListener('click',()=>{
    if(g()>=LIMIT){u();return;}
    const cvss=+document.getElementById('p_cvss').value;
    const epss=+document.getElementById('p_epss').value;
    const kev=document.getElementById('p_kev').checked;
    const exploited=document.getElementById('p_exploited').checked;
    const exploitcode=document.getElementById('p_exploitcode').checked;
    const surface=+document.getElementById('p_surface').value;
    const scopeAdd=+document.getElementById('p_scope').value;
    const asset=+document.getElementById('p_asset').value;
    const biz=+document.getElementById('p_biz').value;
    const data=+document.getElementById('p_data').value;
    const controls=+document.getElementById('p_controls').value;

    // Multipliers
    let mult = surface * asset * biz * data * controls;
    // Additive signals
    let add = scopeAdd;
    if(epss>=50) add += 1; else if(epss>=20) add += 0.5;
    if(kev) add += 1.2;
    if(exploited) add += 1.2;
    if(exploitcode) add += 0.4;

    let score = cvss * mult + add;
    score = Math.max(0, Math.min(10, score));

    const sev=band(score);
    const out=document.getElementById('proOut'); out.style.display='block';
    const active = kev||exploited;
    out.innerHTML = `<h3>Rescored severity: <span class="badge sev-${sev}">${sev}</span> <span class="pill">${score.toFixed(1)}/10</span></h3>
                     <div class="scorebar"><div style="width:${(score/10)*100}%"></div></div>
                     <p class="muted"><strong>Model:</strong> score = CVSS × (exposure × asset × business × data × controls) + (ubiquity + signals).</p>
                     <p><strong>Suggested remediation SLA:</strong> ${sla(sev, surface>=0.95, active)}</p>`;

    sset(g()+1); u();
  });
  document.getElementById('proReset').addEventListener('click',()=>{document.getElementById('proOut').style.display='none';});
</script>
<!-- Terms acceptance modal -->
<div id="disclaimerModal" style="position:fixed;inset:0;background:rgba(0,0,0,.75);display:flex;align-items:center;justify-content:center;z-index:9999;">
<div style="background:#0B1E39;color:#F5F7FB;max-width:600px;padding:24px;border-radius:12px;box-shadow:0 12px 30px rgba(0,0,0,.5)">
<h2 style="margin-top:0">Before You Proceed</h2>
<p>
      By continuing to use the <strong>Vulnerability Criticality Re-Scorer</strong>, you acknowledge that this tool is provided  
      solely as an aid and that <strong>ABI Consulting, LLC</strong> bears no responsibility or liability for any decisions,  
      damages, or outcomes resulting from its use.
    </p>
<button id="acceptDisclaimer" style="margin-top:12px;padding:10px 16px;border:none;border-radius:8px;background:#2E8CFF;color:#fff;font-weight:bold;cursor:pointer;">
      I Accept
    </button>
</div>
</div>
<script>
  document.getElementById("acceptDisclaimer").addEventListener("click", function(){
    document.getElementById("disclaimerModal").style.display = "none";
    localStorage.setItem("vmRescorerAccepted","true");
  });
  // If already accepted, don’t show again
  if(localStorage.getItem("vmRescorerAccepted")==="true"){
    document.getElementById("disclaimerModal").style.display="none";
  }
</script>
</body>
</html>
